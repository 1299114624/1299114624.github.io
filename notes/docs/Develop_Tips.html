<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>编程小技巧 | 个人网站</title>
    <meta name="description" content="叶硕强">
    <link rel="icon" href="/logo.png">
    
    <link rel="preload" href="/assets/css/0.styles.ab6b4e78.css" as="style"><link rel="preload" href="/assets/js/app.a3cdd393.js" as="script"><link rel="preload" href="/assets/js/13.7da82bce.js" as="script"><link rel="prefetch" href="/assets/js/10.d445be6b.js"><link rel="prefetch" href="/assets/js/11.075a3790.js"><link rel="prefetch" href="/assets/js/12.2618d608.js"><link rel="prefetch" href="/assets/js/14.51d3fe3d.js"><link rel="prefetch" href="/assets/js/15.3bd169c9.js"><link rel="prefetch" href="/assets/js/16.281586d7.js"><link rel="prefetch" href="/assets/js/17.4f248283.js"><link rel="prefetch" href="/assets/js/18.76eb502e.js"><link rel="prefetch" href="/assets/js/19.2a67beeb.js"><link rel="prefetch" href="/assets/js/2.252269c5.js"><link rel="prefetch" href="/assets/js/20.5eb0207c.js"><link rel="prefetch" href="/assets/js/21.becaa6f3.js"><link rel="prefetch" href="/assets/js/22.99a87c8f.js"><link rel="prefetch" href="/assets/js/23.96f76d35.js"><link rel="prefetch" href="/assets/js/24.6115317a.js"><link rel="prefetch" href="/assets/js/3.8a12d0ca.js"><link rel="prefetch" href="/assets/js/4.ef16e515.js"><link rel="prefetch" href="/assets/js/5.ffaa29cf.js"><link rel="prefetch" href="/assets/js/6.0460041e.js"><link rel="prefetch" href="/assets/js/7.dc971161.js"><link rel="prefetch" href="/assets/js/8.017c52f5.js"><link rel="prefetch" href="/assets/js/9.f8549d35.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ab6b4e78.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="个人网站" class="logo"> <span class="site-name can-hide">个人网站</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/articles/" class="nav-link">妙笔生花</a></div><div class="nav-item"><a href="/yuki/" class="nav-link">yuki控件库专栏</a></div><div class="nav-item"><a href="/notes/" class="nav-link router-link-active">开发笔记</a></div><div class="nav-item"><a href="/favorite/" class="nav-link">收藏夹</a></div><div class="nav-item"><a href="http://yeshuoqiang.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  个人网站
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/1299114624" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/articles/" class="nav-link">妙笔生花</a></div><div class="nav-item"><a href="/yuki/" class="nav-link">yuki控件库专栏</a></div><div class="nav-item"><a href="/notes/" class="nav-link router-link-active">开发笔记</a></div><div class="nav-item"><a href="/favorite/" class="nav-link">收藏夹</a></div><div class="nav-item"><a href="http://yeshuoqiang.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  个人网站
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/1299114624" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>编程小技巧</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/notes/docs/Develop_Tips.html#代码锁" class="sidebar-link">代码锁</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/notes/docs/Develop_Tips.html#少用-if-中的" class="sidebar-link">少用 if 中的 ||</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/notes/docs/Develop_Tips.html#注意传给后台的参数类型" class="sidebar-link">注意传给后台的参数类型</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/notes/docs/Develop_Tips.html#注释的格式" class="sidebar-link">注释的格式</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/notes/docs/Develop_Tips.html#getters-里不一定只能存值也能存函数" class="sidebar-link">getters 里不一定只能存值也能存函数</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/notes/docs/Develop_Tips.html#vuex-的命名空间-namespaced" class="sidebar-link">vuex 的命名空间 namespaced</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/notes/docs/Develop_Tips.html#从-url-里拿-query-值" class="sidebar-link">从 url 里拿 query 值</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/notes/docs/Develop_Tips.html#取得最高层级的-window-对象" class="sidebar-link">取得最高层级的 window 对象</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/notes/docs/Develop_Tips.html#文件夹模块集合成一个新的输出对象" class="sidebar-link">文件夹模块集合成一个新的输出对象</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/notes/docs/Develop_Tips.html#使用-vuex-控制某组件显隐" class="sidebar-link">使用 vuex 控制某组件显隐</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/notes/docs/Develop_Tips.html#判断浏览器是否兼容ie" class="sidebar-link">判断浏览器是否兼容IE</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/notes/docs/Develop_Tips.html#饿了么表格数据合并" class="sidebar-link">饿了么表格数据合并</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/notes/docs/Develop_Tips.html#所有样式可以放在一个文件夹中" class="sidebar-link">所有样式可以放在一个文件夹中</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="编程小技巧"><a href="#编程小技巧" aria-hidden="true" class="header-anchor">#</a> 编程小技巧</h1> <h2 id="代码锁"><a href="#代码锁" aria-hidden="true" class="header-anchor">#</a> 代码锁</h2> <p>现在有一个保存按钮，为了防止在保存结果返回前多次发送保存请求，我们可以在请求前上锁，请求后解锁（和防止连续快速点击的节流是两回事）</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>canSaving<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>canSaving <span class="token operator">=</span> <span class="token boolean">false</span> <span class="token comment">// 点击完成后立刻把锁关闭</span>
    <span class="token keyword">const</span> saveData <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initSaveData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> bearPromise <span class="token operator">=</span> Services<span class="token punctuation">.</span><span class="token function">updateAllConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        userId<span class="token punctuation">:</span> window<span class="token punctuation">.</span>userId<span class="token punctuation">,</span>
        config<span class="token punctuation">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>saveData<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>bearPromise<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token boolean">false</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> item <span class="token keyword">of</span> res<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>saveErrorMsg <span class="token operator">=</span> item<span class="token punctuation">.</span>ret<span class="token punctuation">.</span>errorMsg
            <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>ret <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>ret<span class="token punctuation">.</span>success<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                value <span class="token operator">=</span> res <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>ret<span class="token punctuation">.</span>success
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> value
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>canSaving <span class="token operator">=</span> <span class="token boolean">true</span> <span class="token comment">// 保存完成后放开锁</span>
        <span class="token operator">...</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="少用-if-中的"><a href="#少用-if-中的" aria-hidden="true" class="header-anchor">#</a> 少用 if 中的 ||</h2> <p>当需要在 if 中判断一个值是否等于多个值中的一个时，可以将多个值写在一个数组中，然后用 indexOf</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> showLst <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'10600620'</span><span class="token punctuation">,</span> <span class="token string">'80400401'</span><span class="token punctuation">]</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>showLst<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>scene_Id<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>isShow <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>isShow <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="注意传给后台的参数类型"><a href="#注意传给后台的参数类型" aria-hidden="true" class="header-anchor">#</a> 注意传给后台的参数类型</h2> <p>有时我们给后台发送请求时，传的 params 不是一个对象而是一个字符串</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token class-name">Service</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">commonQuery</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> paramOpt<span class="token punctuation">,</span> opt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> reqUrl <span class="token operator">=</span> basePath <span class="token operator">+</span> commonQueryURL
    <span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token function">handleParams</span><span class="token punctuation">(</span>paramOpt<span class="token punctuation">)</span>
    <span class="token comment">// 有时我们想临时在这里给后台多传一个东西作为验证，由于 handleParams 将 paramOpt 转换成了字符串，需要先解析</span>
    <span class="token comment">// let params = handleParams(paramOpt)</span>
    <span class="token comment">// params = JSON.parse(params)</span>
    <span class="token comment">// params.solutionId = '90000153'</span>
    <span class="token comment">// params = JSON.stringify(params)</span>
    <span class="token keyword">const</span> req <span class="token operator">=</span> <span class="token punctuation">{</span>
        url<span class="token punctuation">:</span> reqUrl<span class="token punctuation">,</span>
        data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            projectId<span class="token punctuation">,</span>
            params
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        req<span class="token punctuation">.</span>data<span class="token punctuation">.</span>key <span class="token operator">=</span> key
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>opt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>opt<span class="token punctuation">.</span>url<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            req<span class="token punctuation">.</span>url <span class="token operator">=</span> basePath <span class="token operator">+</span> opt<span class="token punctuation">.</span>url
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>opt<span class="token punctuation">.</span>wholeUrl<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            req<span class="token punctuation">.</span>url <span class="token operator">=</span> opt<span class="token punctuation">.</span>wholeUrl
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>opt<span class="token punctuation">.</span>async<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            req<span class="token punctuation">.</span>async <span class="token operator">=</span> opt<span class="token punctuation">.</span>async
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>isNeedMock <span class="token operator">&amp;&amp;</span> mockKeyArr<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        req<span class="token punctuation">.</span>url <span class="token operator">=</span> baseMockUrl <span class="token operator">+</span> key
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">xhr</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="注释的格式"><a href="#注释的格式" aria-hidden="true" class="header-anchor">#</a> 注释的格式</h2> <p>/** */注释的话，你再调用类和方法的时候会出现提示，内容就是你写的注释。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">/**
 * 获取表格控件的data配置
 * @param {Object} vm vue
 * @param {Object} commonParams 公共查询参数
 * @return {Object} 表格控件的data配置
 */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getData</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">vm<span class="token punctuation">,</span> commonParams</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> tableDataCfg <span class="token operator">=</span> vm<span class="token punctuation">.</span>opts<span class="token punctuation">.</span>data
    <span class="token keyword">return</span> fetch <span class="token function">TableData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        vm<span class="token punctuation">,</span>
        key<span class="token punctuation">:</span> tableDataCfg<span class="token punctuation">.</span>key<span class="token punctuation">,</span>
        orderby<span class="token punctuation">:</span> tableDataCfg<span class="token punctuation">.</span>orderby<span class="token punctuation">,</span>
        orderSort<span class="token punctuation">:</span> tableDataCfg<span class="token punctuation">.</span>orderSort <span class="token operator">||</span> <span class="token string">'desc'</span><span class="token punctuation">,</span>
        queryParams<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token operator">...</span>commonParams<span class="token punctuation">,</span>
            <span class="token operator">...</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> tableDataCfg<span class="token punctuation">.</span>queryParams <span class="token operator">===</span> <span class="token string">'function'</span> <span class="token operator">?</span> 
            tableDataCfg<span class="token punctuation">.</span><span class="token function">queryParams</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span> <span class="token punctuation">:</span> 
            tableDataCfg<span class="token punctuation">.</span>queryParams<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="getters-里不一定只能存值也能存函数"><a href="#getters-里不一定只能存值也能存函数" aria-hidden="true" class="header-anchor">#</a> getters 里不一定只能存值也能存函数</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// rightPanelTools </span>
<span class="token keyword">const</span> rightPanelTools <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'90000153'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>exportBtn<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">getTools</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">tools</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">solutionId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> tools<span class="token punctuation">[</span>solutionId<span class="token punctuation">]</span> <span class="token operator">?</span> tools<span class="token punctuation">[</span>solutionId<span class="token punctuation">]</span> <span class="token punctuation">:</span> tools<span class="token punctuation">.</span>default
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">getTools</span><span class="token punctuation">(</span>rightPanelTools<span class="token punctuation">)</span>
</code></pre></div><p>接下来可以写一个配置对象引入该模块并将配置对象存储在 vuex 的 state 中，这样就能通过 getter 得到一个函数，通过传入不同的参数拿到不同的东西</p> <p>将模块写进配置文件：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> rightPanelTools<span class="token punctuation">,</span> collapse<span class="token punctuation">,</span> back<span class="token punctuation">,</span> path <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/config/atom/right-panel'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    common<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>
        rightPanelTools<span class="token punctuation">:</span> rightPanelTools<span class="token punctuation">,</span>
        <span class="token operator">...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>getters 内容如下：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> getters <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// gis预置配置</span>
    <span class="token function-variable function">gisPrepare</span><span class="token punctuation">:</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>common<span class="token punctuation">.</span>gisPrepare<span class="token punctuation">,</span>
    <span class="token comment">// 右侧面板工具栏配置</span>
    <span class="token function-variable function">rightPanelTools</span><span class="token punctuation">:</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>common<span class="token punctuation">.</span>rightPanelTools<span class="token punctuation">,</span>
    <span class="token comment">// 返回上一层按钮事件</span>
    <span class="token function-variable function">backEvents</span><span class="token punctuation">:</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>common<span class="token punctuation">.</span>backEvents<span class="token punctuation">,</span>
    <span class="token comment">// 面包屑事件</span>
    <span class="token function-variable function">pathEvents</span><span class="token punctuation">:</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>common<span class="token punctuation">.</span>pathEvents
<span class="token punctuation">}</span>
</code></pre></div><p>在需要用的地方读取 vuex 中存的这个函数传入 solutionId</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span><span class="token function">mapGetters</span><span class="token punctuation">(</span><span class="token string">'frameConfig'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'rightPanelTools'</span><span class="token punctuation">,</span> <span class="token string">'pathEvents'</span><span class="token punctuation">,</span> <span class="token string">'backEvents'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function-variable function">rightPanelToolLst</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">rightPanelTools</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>solutionId<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="vuex-的命名空间-namespaced"><a href="#vuex-的命名空间-namespaced" aria-hidden="true" class="header-anchor">#</a> vuex 的命名空间 namespaced</h2> <p>store 下的 index.js 引入 modules 文件并带有 namespaced: true，在使用前需要加上该命名空间</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> frameConfig <span class="token keyword">from</span> <span class="token string">'./modules/frameConfig.js'</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    state<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    getters<span class="token punctuation">,</span>
    mutations<span class="token punctuation">,</span>
    modules<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        frameConfig
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>frameConfig.js ：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> getters <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// gis预置配置</span>
    <span class="token function-variable function">gisPrepare</span><span class="token punctuation">:</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>common<span class="token punctuation">.</span>gisPrepare<span class="token punctuation">,</span>
    <span class="token comment">// 右侧面板工具栏配置</span>
    <span class="token function-variable function">rightPanelTools</span><span class="token punctuation">:</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>common<span class="token punctuation">.</span>rightPanelTools<span class="token punctuation">,</span>
    <span class="token comment">// 返回上一层按钮事件</span>
    <span class="token function-variable function">backEvents</span><span class="token punctuation">:</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>common<span class="token punctuation">.</span>backEvents<span class="token punctuation">,</span>
    <span class="token comment">// 面包屑事件</span>
    <span class="token function-variable function">pathEvents</span><span class="token punctuation">:</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>common<span class="token punctuation">.</span>pathEvents
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    namespaced<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    getters
<span class="token punctuation">}</span>
</code></pre></div><p>在引入时需在前方加上命名空间</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">...</span><span class="token function">mapGetters</span><span class="token punctuation">(</span><span class="token string">'frameConfig'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'rightPanelTools'</span><span class="token punctuation">,</span> <span class="token string">'pathEvents'</span><span class="token punctuation">,</span> <span class="token string">'backEvents'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="从-url-里拿-query-值"><a href="#从-url-里拿-query-值" aria-hidden="true" class="header-anchor">#</a> 从 url 里拿 query 值</h2> <p><strong>http://domain.com/?search=a#hash</strong></p> <p>?search=a 整个指的是 location.search, #hash 是 location.hash 或者叫 fragment, 而 query 则指的是以第一个 ? 开始，至行尾或者 # 结束，fragment 则以 # 开始，行尾结束</p> <p>对 URL 在 # 之后的部分做变动不会刷新页面，你可以在浏览器的 console 里分别输入 window.location.hash='#hash' 和 window.location.search=&quot;?sa&quot; 执行看看结果，后者是会刷新页面的。在HTML5中有 History API 可以不刷新页面对 URL 进行修改，就不用加一个 # 来防刷新了。另外有 # 分隔做单页应用的时候服务器那边也好处理</p> <p><strong>http://unb61.huawei.com/NPCapacityPlanningWebsite/appscene/capacityPlanSettings/index.jsp?cur_project_id=40001452115555&amp;cur_scene_id=1000800&amp;schemeId=1</strong></p> <p>要想在上述 url 中取得 schemeId 并挂载到 window 对象上时可以写一个方法</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">getCapacitySchemeId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> schemeIdMatchArr <span class="token operator">=</span> <span class="token regex">/\.*schemeId=(\d*)/</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token punctuation">)</span>
        <span class="token keyword">let</span> capacitySchemeId <span class="token operator">=</span> <span class="token keyword">null</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>schemeIdMatchArr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            capacitySchemeId <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>schemeIdMatchArr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        window<span class="token punctuation">.</span>capacitySchemeId <span class="token operator">=</span> capacitySchemeId
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="取得最高层级的-window-对象"><a href="#取得最高层级的-window-对象" aria-hidden="true" class="header-anchor">#</a> 取得最高层级的 window 对象</h2> <p>当存在多个 iframe 嵌套时，我们想拿到最外面的 window 对象，则需要封装一个函数</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">getWindowTop</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">doc</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>doc<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>doc <span class="token operator">!==</span> doc<span class="token punctuation">.</span>parent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token function">getWindowTop</span><span class="token punctuation">(</span>doc<span class="token punctuation">.</span>parent<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> doc
    <span class="token punctuation">}</span>
    <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> doc
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>使用时直接传入当前所在的 window 对象</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getWindowTop</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">.</span>solutionId<span class="token punctuation">)</span>
</code></pre></div><h2 id="文件夹模块集合成一个新的输出对象"><a href="#文件夹模块集合成一个新的输出对象" aria-hidden="true" class="header-anchor">#</a> 文件夹模块集合成一个新的输出对象</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// index.js</span>
<span class="token keyword">import</span> tools <span class="token keyword">from</span> <span class="token string">'./tools'</span>
<span class="token keyword">import</span> rightCollapse <span class="token keyword">from</span> <span class="token string">'./collapse'</span>
<span class="token keyword">import</span> rightBack <span class="token keyword">from</span> <span class="token string">'./back'</span>
<span class="token keyword">import</span> rightPath <span class="token keyword">from</span> <span class="token string">'./path'</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> rightPanelTools <span class="token operator">=</span> toos
<span class="token keyword">export</span> <span class="token keyword">const</span> collapse <span class="token operator">=</span> rightCollapse
<span class="token keyword">export</span> <span class="token keyword">const</span> back <span class="token operator">=</span> rightBack
<span class="token keyword">export</span> <span class="token keyword">const</span> path <span class="token operator">=</span> rightPath
</code></pre></div><p>使用时</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>rightPanelTools<span class="token punctuation">,</span> collapse<span class="token punctuation">,</span> back<span class="token punctuation">,</span> path<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/config/atom/right-panel'</span>
</code></pre></div><h2 id="使用-vuex-控制某组件显隐"><a href="#使用-vuex-控制某组件显隐" aria-hidden="true" class="header-anchor">#</a> 使用 vuex 控制某组件显隐</h2> <p>vuex 代码如下</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> mutations <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// 设置右侧覆盖</span>
    <span class="token function">setRightCover</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        state<span class="token punctuation">.</span>rightCover <span class="token operator">=</span> <span class="token punctuation">{</span>
            key<span class="token punctuation">:</span> val<span class="token punctuation">.</span>key<span class="token punctuation">,</span>
            addParams<span class="token punctuation">:</span> val<span class="token punctuation">.</span>addParams
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> getters <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">rightCoverShow</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> state<span class="token punctuation">.</span>rightCover <span class="token operator">&amp;&amp;</span> state<span class="token punctuation">.</span>rightCover<span class="token punctuation">.</span>key
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>使用时 v-if 可以写在组件外面</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>right-cover</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>rightCoverShow<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>right-cover</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span>mapGetters<span class="token punctuation">,</span> mapMutations<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vuex'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span><span class="token function">mapGetters</span><span class="token punctuation">(</span><span class="token string">'rightCoverShow'</span><span class="token punctuation">,</span> <span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span><span class="token function">mapMutations</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'setRightCover'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setRightCover</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                key<span class="token punctuation">:</span> <span class="token string">'rightChainDetail'</span><span class="token punctuation">,</span>
                addParams<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    id<span class="token punctuation">:</span> rowData<span class="token punctuation">.</span>id
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">goBack</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> curRightCover <span class="token operator">=</span> window<span class="token punctuation">.</span>capacityPlanFrameConfig<span class="token punctuation">.</span>rightCover<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>rightCover<span class="token punctuation">.</span>key<span class="token punctuation">]</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>curRightCover <span class="token operator">&amp;&amp;</span> curRightCover<span class="token punctuation">.</span>beforeBack<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                curRightCover<span class="token punctuation">.</span><span class="token function">beforeBack</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setRightCover</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                key<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
                addParams<span class="token punctuation">:</span> <span class="token keyword">null</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong><code>window.capacityPlanFrameConfig.rightCover[this.rightCover.key]</code> 是 cover.js 中的一个对象，它的 beforeBack 规定了返回前执行的函数</strong></p> <p>cover.js 的配置文件如下</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">/**
 * @desc 右侧覆盖
 */</span>
<span class="token keyword">import</span> <span class="token constant">I18N</span> <span class="token keyword">from</span> <span class="token string">'@/lang/i18n'</span>
<span class="token keyword">import</span> textCard <span class="token keyword">from</span> <span class="token string">'@/config/atom/text/text-card'</span>
<span class="token keyword">import</span> table <span class="token keyword">from</span> <span class="token string">'@/config/atom/table'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token comment">// 环链详情</span>
    rightChainDetail<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        title<span class="token punctuation">:</span> <span class="token constant">I18N</span><span class="token punctuation">.</span><span class="token constant">RING_CHAIN_DETAIL</span><span class="token punctuation">,</span>
        compList<span class="token punctuation">:</span> <span class="token punctuation">[</span>textCard<span class="token punctuation">.</span>ringChainDetail<span class="token punctuation">,</span> table<span class="token punctuation">.</span>deviceUpgradeTypeOnRing<span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token function-variable function">beforeBack</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">vm</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            vm<span class="token punctuation">.</span>$root<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'legend'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
                <span class="token punctuation">{</span>type<span class="token punctuation">:</span> <span class="token string">'refresh'</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> vm<span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>pageIndex<span class="token punctuation">}</span>
            <span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 链路详情 环链信息</span>
    linkInringDetail<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        title<span class="token punctuation">:</span> <span class="token constant">I18N</span><span class="token punctuation">.</span><span class="token constant">LINK_DETAIL</span><span class="token punctuation">,</span>
        compList<span class="token punctuation">:</span> <span class="token punctuation">[</span>textCard<span class="token punctuation">.</span>linkDetailstate<span class="token punctuation">,</span> table<span class="token punctuation">.</span>ringChainServiceState<span class="token punctuation">,</span> table<span class="token punctuation">.</span>ringChainList<span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token function-variable function">beforeBack</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">vm</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            vm<span class="token punctuation">.</span>$root<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'GisView'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
                <span class="token punctuation">{</span>type<span class="token punctuation">:</span> <span class="token string">'clearLayer'</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'ringDetailLinkPointLayer'</span><span class="token punctuation">,</span> <span class="token string">'ringDetailLinkLineLayer'</span><span class="token punctuation">,</span>
                <span class="token string">'ringDetailRingPointLayer'</span><span class="token punctuation">,</span><span class="token string">'ringDetailRingLineLayer'</span><span class="token punctuation">,</span> <span class="token string">'ringDetailRingLineLayerMidText'</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
            <span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>将 cover.js 输出对象挂载到 window 对象上的方式如下</p> <p>config__scene__5g-ready__index.js</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">/**
 * @desc np场景界面配置
 */</span>
<span class="token keyword">import</span> pageTools <span class="token keyword">from</span> <span class="token string">'./page-tools'</span>
<span class="token keyword">import</span> rightCover <span class="token keyword">from</span> <span class="token string">'@/config/atom/right-panel/cover'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    common<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    pageMap<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    pageTools<span class="token punctuation">,</span>
    rightCover
<span class="token punctuation">}</span>
</code></pre></div><p>config__scene__frameMain.js</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> scene5GReadyConfig <span class="token keyword">from</span> <span class="token string">'@/config/scene/5g-ready/index.js'</span>
<span class="token keyword">import</span> sceneNPConfig <span class="token keyword">from</span> <span class="token string">'@/config/scene/np/index.js'</span>
<span class="token keyword">const</span> sceneConfigMap <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token number">10100000</span><span class="token punctuation">:</span> scene5GReadyConfig<span class="token punctuation">,</span>
    <span class="token number">10600620</span><span class="token punctuation">:</span> sceneNPConfig
<span class="token punctuation">}</span>
window<span class="token punctuation">.</span>capacityPlanFrameConfig <span class="token operator">=</span> sceneConfigMap<span class="token punctuation">[</span>window<span class="token punctuation">.</span>sceneId<span class="token punctuation">]</span>
</code></pre></div><h2 id="判断浏览器是否兼容ie"><a href="#判断浏览器是否兼容ie" aria-hidden="true" class="header-anchor">#</a> 判断浏览器是否兼容IE</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">checkIECompatibility</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> userAgent <span class="token operator">=</span> navigator<span class="token punctuation">.</span>userAgent<span class="token punctuation">;</span>
    <span class="token keyword">let</span> isIE <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>
        userAgent<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'Trident'</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">||</span> userAgent<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'compatible'</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
        userAgent<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'MSIE'</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>userAgent<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'Opera'</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        isIE <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> isIE
<span class="token punctuation">}</span>
</code></pre></div><h2 id="饿了么表格数据合并"><a href="#饿了么表格数据合并" aria-hidden="true" class="header-anchor">#</a> 饿了么表格数据合并</h2> <p>假设一个表格有 10 行，我们想让第一列每两行合并一次，第二列的前三行合并，第二列的第四第五行合并，则传入的 spanMethod可以这样写</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">spanMethod</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>row<span class="token punctuation">,</span> column<span class="token punctuation">,</span> rowIndex<span class="token punctuation">,</span> columnIndex<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> subrackNumberArr<span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>columnIndex <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>rowIndex <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                rowspan<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                colspan<span class="token punctuation">:</span> <span class="token number">1</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                rowspan<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                colspan<span class="token punctuation">:</span> <span class="token number">0</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>columnIndex <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> spanIndex <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> subrackNumberArr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>rowIndex <span class="token operator">===</span> spanIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token punctuation">{</span>
                    rowspan<span class="token punctuation">:</span> subrackNumberArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>
                    colspan<span class="token punctuation">:</span> <span class="token number">1</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            spanIndex <span class="token operator">+=</span> subrackNumberArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            rowspan<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            colspan<span class="token punctuation">:</span> <span class="token number">0</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果是动态数据请求，想把第二列相同数据的单元格行合并则可以写一个函数来输出上述的 subrackNumberArr</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">getSpanParam</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> total <span class="token operator">=</span> res<span class="token punctuation">.</span>length
    <span class="token keyword">const</span> subrackNumberArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>length <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// subrackNumber 指的是要进行比较数据是否相同的那个单元格 value 值</span>
    <span class="token keyword">let</span> subrackNumber <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>subrackNumber
    <span class="token keyword">let</span> boardBusCount <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> res<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>subrackNumber <span class="token operator">===</span> subrackNumber<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            boardBusCount <span class="token operator">++</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            subrackNumberArr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>boardBusCount<span class="token punctuation">)</span>
            boardBusCount <span class="token operator">=</span> <span class="token number">1</span>
            subrackNumber <span class="token operator">=</span> res<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>subrackNumber
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    subrackNumberArr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>boardBusCount<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        subrackNumberArr<span class="token punctuation">,</span>
        total
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> spanParamObj <span class="token operator">=</span> <span class="token function">getSpanParam</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
</code></pre></div><h2 id="所有样式可以放在一个文件夹中"><a href="#所有样式可以放在一个文件夹中" aria-hidden="true" class="header-anchor">#</a> 所有样式可以放在一个文件夹中</h2> <p>可以在组件内不要包含 style 样式，直接全部提取到一个文件夹中，方便修改，使用时在 main.js 里引入</p> <p>代码结构如下</p> <div class="language- extra-class"><pre class="language-text"><code>atom
├─ main.js
├─ style
|  ├─ index.scss
|  ├─ gisTools.scss
|  └─ chart.scss
</code></pre></div><div class="language-scss extra-class"><pre class="language-scss"><code><span class="token keyword">@import</span> <span class="token string">'./chart.scss'</span><span class="token punctuation">;</span>
<span class="token keyword">@import</span> <span class="token string">'./gisTools.scss'</span><span class="token punctuation">;</span>
<span class="token selector">html </span><span class="token punctuation">{</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">#capacity-plan </span><span class="token punctuation">{</span>
    <span class="token comment">/* 隐藏高德地图图标 */</span>
    <span class="token selector">.amap-logo </span><span class="token punctuation">{</span>
        <span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.leftWrapStyle &gt; .left-wraper </span><span class="token punctuation">{</span>
        <span class="token property">border-top</span><span class="token punctuation">:</span> 40px solid <span class="token function">rgb</span><span class="token punctuation">(</span>44<span class="token punctuation">,</span>50<span class="token punctuation">,</span>76<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.a3cdd393.js" defer></script><script src="/assets/js/13.7da82bce.js" defer></script>
  </body>
</html>
